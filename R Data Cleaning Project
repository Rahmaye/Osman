#Question or Decision: The research question examines the relationship between hospital readmission rates and various health determinants. 
#My required dependent variable is patient complication risk, and my independent variables are, Age, gender, the number of children, and the risk for high blood pressure, obesity, anxiety, allergic rhinitis, and reflux esophagitis.
#install packages used in data cleaning and analysis
install.packages("readr")
install.packages("dplyr")
install.packages("tidyr")
install.packages("ggplot2")
install.packages("ggplot.multistats")
install.packages("psych")

library(tidyr)
library(readr)
library(dplyr)
library(ggplot.multistats)
library(ggplot2)
library(psych)


medical_raw_data <- read_csv("medical_raw_data.csv") #name and import data
View(medical_raw_data)
str(medical_raw_data) # explore the data set by viewing the number of rows and 
#columns, data types, etc.
medical <- medical_raw_data[,c(2,7,12,13,15:45)] #delete columns not relevant 



##medical$Complication_risk <- as.numeric(as.factor(medical$Complication_risk))
#convert categorical data to numeric

factorfunction <- function(x) {as.numeric(as.factor(x))} #create function to change
#categorical columns to numeric

factoredColumns <- sapply(medical[,c(2,4,8,9,11:13,18:21,22,24:27,29:32)], factorfunction) #apply
# function created above to all categorical columns
medical[,c(2,4,8,9,11:13,18:21,22,24:27,29:32)] <- factoredColumns #replace categorical columns
#with factored column

medical <- medical[,c(6,7,12,20,22,23,28:30)]

medical <- na.omit(medical) # omit na values

#PCA - look at PCA for all x variables
medical.pca <- prcomp(medical, TRUE, TRUE) #medical = dataset True = centering variables relative to dataset 
# True 2: 
summary(medical.pca)
#98% of the variation of the data is explained by component 1

#build linear regression model to see relationship between readmission and other variables
y <- medical$Complication_risk #identify dependent variable
medical.m <- lm (y~medical$Children + medical$Age + medical$Gender + medical$HighBlood
                  + medical$Overweight + medical$Anxiety + medical$Allergic_rhinitis
                 + medical$Reflux_esophagitis) #linear model 
summary(medical.m)

#Only allergic_rhinitis is significant at the 0.01 significance level. This is the only 
# variable that can be used as a determinant of complication_risk

#########################END###########
